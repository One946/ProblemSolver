<!DOCTYPE html>
<html>
<head>
  <title>Registrati</title>
  <link rel="stylesheet" type="text/css" href="http://localhost/2.0/css/main.css">
  <link rel="stylesheet" type="text/css" href="http://localhost/2.0/css/registrati.css">
</head>
<body>

<div class="container">
      <nav class="navbar">
          <span class="open-slide">
            <a href="#" onclick="openSlideMenu()">
              <svg width="30" height="30">
                <path d = "M0,5 30,5" stroke="#fff" stroke-width="5"/>
                <path d = "M0,14 30,14" stroke="#fff" stroke-width="5"/>
                <path d = "M0,23 30,23" stroke="#fff" stroke-width="5"/>
              </svg>
            </a>
          </span>
          <ul class="navbar-nav">
            <li><a href="http://localhost/2.0/index.html">Home</a></li>
            <li><a href="http://localhost/2.0/problemi.html">Naviga Problemi</a></li>
            <li><a href="http://localhost/2.0/report.html">Riporta Problema</a></li>
            <li><a href="#">Login/Registrati</a></li>
            <li><a href="http://localhost/2.0/cerca.html"> Cerca Problemi</a><li>
            <button id="p"style="background-color:#3b5998; color:white; border:none;margin-top:15px;">LogOut</button>
          </ul>
              <script>
                //verifico se l'utente è loggato
                var logged = document.cookie.substring(document.cookie.indexOf("secretID:"),document.cookie.indexOf(";"));
                var a = logged.split("=");
                var id = parseInt(a[1]);
                if(!isNaN(id)){
                  document.getElementById("p").style.visibility="visibile";
                }else{
                  document.getElementById("p").style.visibility="hidden";
                }
      
      
                document.getElementById("p").addEventListener("click",logout);
                //funzione di logout
              function logout(){
                var d = new Date();
                  d.setTime(d.getTime() *0);
                  var expires = "expires="+ d.toUTCString();
                  console.log(document.cookie);
                  console.log(document.cookie["secretID"]);
                  //document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
                document.cookie="secretID"+"="+document.cookie+";"+expires+"path=/"
                console.log(document.cookie);
              }
              </script>
          </ul>
  
        </nav>
      <!--Menu a scomparsa--> 
        <div id="side-menu" class="side-nav">
            <a href="#" class="btn-close" onclick="closeSlideMenu()">&times;</a>
            <a href="http://localhost/2.0/index.html">Home</a>
            <a href="http://localhost/2.0/problemi.html">Naviga Problemi</a></a>
            <li><a href="http://localhost/2.0/risolti.html">Naviga Problemi Risolti</a></li>
            <a href="http://localhost/2.0/report.html">Riporta Problema</a>
            <a href="#">Login/Registrati</a>
            <li><a href="http://localhost/2.0/cerca.html"> Cerca Problemi</a><li>
        </div>

<!--Form di registrazione-->
  <form id="form">
      <h1>Registrati</h1>
      <p>Inserisci i tuoi dati per creare un account.</p>

      <label for="email"><b> Email </b></label>
      <input type="text" placeholder="Email" id="email" required>

      <label for="nome"><b> Nome </b></label>
      <input type="text" placeholder="Nome" id="nome" required>

      <label for="cognome"><b> Cognome </b></label>
      <input type="text" placeholder="Cognome" id="cognome" required>

      <label for="cf"><b> Codice Fiscale </b></label>
      <input type="text" placeholder="Codice Fiscale" id="cf" required maxlength="16" minlength="16">

      <label for="psw"><b> Password </b></label>
      <input type="password" placeholder="Password" id="password" required>

      <label for="pswr"><b> Inserisci nuovamente la password </b></label>
      <input type="password" placeholder="Password" id="passwordr" required>

      <label for="secretID"><b> Inserisci un numero utente che sarà utilizzato per garantire la tua privacy</b></label>
      <input type="text" placeholder="secretID" id="secretID" required>
      
      
      <a class="termini" href="#" style="color:dodgerblue">Termini e Politiche di Privacy</a>

      <div class="clearfix">
        <button class="cancelbtn">Cancel</button>
        <button class="signupbtn">Sign Up</button>
      </div>
    </form>
</div>

<script>
  document.getElementById("form").addEventListener("submit",registra)
  function registra(e){
    e.preventDefault();
    var json={
      email:document.getElementById("email").value,
      nome:document.getElementById("nome").value,
      cognome:document.getElementById("cognome").value,
      cf:document.getElementById("cf").value,
      password:document.getElementById("password").value,
      passwordr:document.getElementById("passwordr").value,
      secretID:document.getElementById("secretID").value
    };
    console.log(json);
    var xhr= new XMLHttpRequest();
    xhr.open("POST","http://localhost/2.0/php/register.php");
    xhr.onload=function (){
        console.log(this.responseText);
    };
    xhr.send(JSON.stringify(json));
  }



//sccript per menù a scomparsa
		function openSlideMenu(){
			document.getElementById("side-menu").style.width="250px"
			document.getElementById("main.").style.marginLeft="250px"
		}
		function closeSlideMenu(){
			document.getElementById("side-menu").style.width="0px"
			document.getElementById("main.").style.marginLeft="0px"
		}
</script>

</body>
</html>
